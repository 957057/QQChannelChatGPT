import{_ as b}from"./UiParentCard.vue_vue_type_script_setup_true_lang-0734075c.js";import{x as $,o as a,c as r,w as n,a as d,a6 as T,b as c,K as j,e as C,t as p,G as F,A as k,L as I,a7 as P,J as D,s as i,d as B,F as u,u as m,f as L,V as O,a8 as q,R as f,a9 as x,O as v,aa as U,i as w,q as S,k as y}from"./index-0719535f.js";const z={class:"d-sm-flex align-center justify-space-between"},G=$({__name:"ConfigGroupCard",props:{title:String},setup(s){const t=s;return(g,o)=>(a(),r(D,{variant:"outlined",elevation:"0",class:"withbg",style:{width:"50%"}},{default:n(()=>[d(T,{style:{padding:"10px 20px"}},{default:n(()=>[c("div",z,[d(j,null,{default:n(()=>[C(p(t.title),1)]),_:1}),d(F)])]),_:1}),d(k),d(I,null,{default:n(()=>[P(g.$slots,"default")]),_:3})]),_:3}))}}),A={style:{display:"flex","flex-direction":"row","justify-content":"space-between","align-items":"center","margin-bottom":"12px"}},E={style:{display:"flex","flex-direction":"row"}},J={style:{"margin-right":"10px",color:"black"}},K={style:{color:"#222"}},N=$({__name:"ConfigGroupItem",props:{title:String,desc:String,btnRoute:String,namespace:String},setup(s){const t=s;return(g,o)=>(a(),i("div",A,[c("div",E,[c("h3",J,p(t.title),1),c("p",K,p(t.desc),1)]),d(B,{to:t.btnRoute,color:"primary",class:"ml-2",style:{"border-radius":"10px"}},{default:n(()=>[C("配置")]),_:1},8,["to"])]))}}),H={style:{display:"flex","flex-direction":"row",padding:"16px",gap:"16px",width:"100%"}},M={name:"ConfigPage",components:{UiParentCard:b,ConfigGroupCard:G,ConfigGroupItem:N},data(){return{config_data:[],config_base:[],save_message_snack:!1,save_message:"",save_message_success:"",config_outline:[],namespace:""}},mounted(){this.getConfig()},methods:{switchConfig(s){f.get("/api/configs?namespace="+s).then(t=>{this.config_data=t.data.data,console.log(this.config_data)})},getConfig(){f.get("/api/config_outline").then(s=>{this.config_outline=s.data.data,console.log(this.config_outline)}),f.get("/api/configs").then(s=>{this.config_base=s.data.data,console.log(this.config_data)})},updateConfig(){f.post("/api/configs",{base_config:this.config_base,config:this.config_data,namespace:this.namespace}).then(s=>{s.data.status==="success"?(this.save_message=s.data.message,this.save_message_snack=!0,this.save_message_success="success"):(this.save_message=s.data.message,this.save_message_snack=!0,this.save_message_success="error")})}}},X=Object.assign(M,{setup(s){return(t,g)=>(a(),i(u,null,[d(O,null,{default:n(()=>[c("div",H,[(a(!0),i(u,null,m(t.config_outline,o=>(a(),r(G,{key:o.name,title:o.name},{default:n(()=>[(a(!0),i(u,null,m(o.body,e=>(a(),r(N,{title:e.title,desc:e.desc,namespace:e.namespace,onClick:l=>t.switchConfig(e.namespace)},null,8,["title","desc","namespace","onClick"]))),256))]),_:2},1032,["title"]))),128))]),d(L,{cols:"12",md:"12"},{default:n(()=>[(a(!0),i(u,null,m(t.config_data,o=>(a(),r(b,{key:o.name,title:o.name,style:{"margin-bottom":"16px"}},{default:n(()=>[(a(!0),i(u,null,m(o.body,e=>(a(),i(u,null,[e.config_type==="item"?(a(),i(u,{key:0},[e.val_type==="bool"?(a(),r(x,{key:0,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.name,hint:e.description,color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label","hint"])):e.val_type==="string"?(a(),r(v,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.name,hint:e.description,style:{"margin-bottom":"8px"},variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"])):e.val_type==="int"?(a(),r(v,{key:2,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.name,hint:e.description,style:{"margin-bottom":"8px"},variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"])):e.val_type==="list"?(a(),i(u,{key:3},[c("span",null,p(e.name),1),d(U,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,chips:"",clearable:"",label:"请添加",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:n(({attrs:l,item:_,select:V,selected:h})=>[d(w,S(l,{"model-value":h,closable:"",onClick:V,"onClick:close":R=>t.remove(_)}),{default:n(()=>[c("strong",null,p(_),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):y("",!0)],64)):e.config_type==="divider"?(a(),r(k,{key:1,style:{"margin-top":"8px","margin-bottom":"8px"}})):y("",!0)],64))),256))]),_:2},1032,["title"]))),128)),(a(!0),i(u,null,m(t.config_base,o=>(a(),r(b,{key:o.name,title:o.name,style:{"margin-bottom":"16px"}},{default:n(()=>[(a(!0),i(u,null,m(o.body,e=>(a(),i(u,null,[e.config_type==="item"?(a(),i(u,{key:0},[e.val_type==="bool"?(a(),r(x,{key:0,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.name,hint:e.description,color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label","hint"])):e.val_type==="string"?(a(),r(v,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.name,hint:e.description,style:{"margin-bottom":"8px"},variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"])):e.val_type==="int"?(a(),r(v,{key:2,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,label:e.name,hint:e.description,style:{"margin-bottom":"8px"},variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","label","hint"])):e.val_type==="list"?(a(),i(u,{key:3},[c("span",null,p(e.name),1),d(U,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,chips:"",clearable:"",label:"请添加",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:n(({attrs:l,item:_,select:V,selected:h})=>[d(w,S(l,{"model-value":h,closable:"",onClick:V,"onClick:close":R=>t.remove(_)}),{default:n(()=>[c("strong",null,p(_),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):y("",!0)],64)):e.config_type==="divider"?(a(),r(k,{key:1,style:{"margin-top":"8px","margin-bottom":"8px"}})):y("",!0)],64))),256))]),_:2},1032,["title"]))),128))]),_:1})]),_:1}),d(B,{icon:"mdi-content-save",size:"x-large",style:{position:"fixed",right:"52px",bottom:"52px"},color:"darkprimary",onClick:t.updateConfig},null,8,["onClick"]),d(q,{timeout:2e3,elevation:"24",color:t.save_message_success,modelValue:t.save_message_snack,"onUpdate:modelValue":g[0]||(g[0]=o=>t.save_message_snack=o)},{default:n(()=>[C(p(t.save_message),1)]),_:1},8,["color","modelValue"])],64))}});export{X as default};
