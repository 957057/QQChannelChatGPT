import{x as I,o,c as i,w as l,a as s,a8 as X,b as c,K as Y,e as h,t as g,G as Z,A as $,L as D,a9 as x,J as A,s as f,d as q,F as b,u as p,V as ee,O as B,k as V,ac as z,ad as E,i as J,q as Q,p as O,a3 as G,N as P,ab as ae,T as R,a4 as N,Q as k,R as F}from"./index-25639696.js";import{_ as te}from"./ConfigDetailCard-0eb16275.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";import"./UiParentCard.vue_vue_type_script_setup_true_lang-b010c672.js";const oe={class:"d-sm-flex align-center justify-space-between"},se=I({__name:"ConfigGroupCard",props:{title:String},setup(m){const e=m;return(t,_)=>(o(),i(A,{variant:"outlined",elevation:"0",class:"withbg",style:{width:"50%"}},{default:l(()=>[s(X,{style:{padding:"10px 20px"}},{default:l(()=>[c("div",oe,[s(Y,null,{default:l(()=>[h(g(e.title),1)]),_:1}),s(Z)])]),_:1}),s($),s(D,null,{default:l(()=>[x(t.$slots,"default")]),_:3})]),_:3}))}}),ne={style:{display:"flex","flex-direction":"row","justify-content":"space-between","align-items":"center","margin-bottom":"12px"}},de={style:{display:"flex","flex-direction":"row"}},ie={style:{"margin-right":"10px",color:"black"}},me={style:{color:"#222"}},ue=I({__name:"ConfigGroupItem",props:{title:String,desc:String,btnRoute:String,namespace:String},setup(m){const e=m;return(t,_)=>(o(),f("div",ne,[c("div",de,[c("h3",ie,g(e.title),1),c("p",me,g(e.desc),1)]),s(q,{to:e.btnRoute,color:"primary",class:"ml-2",style:{"border-radius":"10px"}},{default:l(()=>[h("配置")]),_:1},8,["to"])]))}}),re={props:{metadata:Object,iterable:Object,metadataKey:String}};function fe(m,e,t,_,M,a){return o(),i(D,{style:{"margin-top":"8px"}},{default:l(()=>[(o(!0),f(b,null,p(t.iterable,(d,n)=>(o(),i(ee,{key:n,style:{"margin-bottom":"2px"}},{default:l(()=>{var C,y,U,w,K,L,u,S,T;return[((C=t.metadata[t.metadataKey].items[n])==null?void 0:C.type)==="string"&&n!=="name"?(o(),i(B,{key:0,modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,label:((y=t.metadata[t.metadataKey].items[n])==null?void 0:y.description)+"("+n+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):V("",!0),(((U=t.metadata[t.metadataKey].items[n])==null?void 0:U.type)==="int"||((w=t.metadata[t.metadataKey].items[n])==null?void 0:w.type)==="float")&&n!=="name"?(o(),i(B,{key:1,modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,label:((K=t.metadata[t.metadataKey].items[n])==null?void 0:K.description)+"("+n+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):((L=t.metadata[t.metadataKey].items[n])==null?void 0:L.type)==="bool"?(o(),i(z,{key:2,modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,label:((u=t.metadata[t.metadataKey].items[n])==null?void 0:u.description)+"("+n+")",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label"])):((S=t.metadata[t.metadataKey].items[n])==null?void 0:S.type)==="list"?(o(),i(E,{key:3,variant:"outlined",modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,chips:"",clearable:"",label:((T=t.metadata[t.metadataKey].items[n])==null?void 0:T.description)+"("+n+")",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:l(({attrs:r,item:j,select:H,selected:W})=>[s(J,Q(r,{"model-value":W,closable:"",onClick:H,"onClick:close":Ve=>m.remove(j)}),{default:l(()=>[c("strong",null,g(j),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])):V("",!0)]}),_:2},1024))),128))]),_:1})}const v=le(re,[["render",fe]]);const ge=c("h2",null,"消息平台",-1),ce=c("h2",{style:{"margin-bottom":"16px","margin-top":"16px"}},"通用配置",-1),_e=c("h2",null,"LLM",-1),be=c("h2",{style:{"margin-bottom":"16px"}},"通用配置",-1),pe={name:"ConfigPage",components:{ConfigGroupCard:se,ConfigGroupItem:ue,ConfigDetailCard:te,AstrBotConfig:v},data(){return{config_data:{config:{platform:[],llm:[],platform_settings:{},llm_settings:{}}},metadata:{},save_message_snack:!1,save_message:"",save_message_success:"",namespace:"",tab:0,tabPlatform:0,tabLLM:0,tabs_key:["消息平台","大语言模型","其他配置"],common_configs_key:[]}},mounted(){this.getConfig()},methods:{getConfig(){R.get("/api/configs").then(m=>{this.config_data=m.data.data.config,this.metadata=m.data.data.metadata;for(let e in this.config_data)e!="platform"&&e!="llm"&&e!="platform_settings"&&e!="llm_settings"&&e!="content_safety"&&this.common_configs_key.push(e)}).catch(m=>{save_message=m,save_message_snack=!0,save_message_success="error"})},updateConfig(){R.post("/api/astrbot-configs",this.config_data).then(m=>{m.data.status==="success"?(this.save_message=m.data.message,this.save_message_snack=!0,this.save_message_success="success"):(this.save_message=m.data.message,this.save_message_snack=!0,this.save_message_success="error")}).catch(m=>{this.save_message=m,this.save_message_snack=!0,this.save_message_success="error"})}}},Ue=Object.assign(pe,{setup(m){return(e,t)=>{const _=O("v-tabs-window-item"),M=O("v-tabs-window");return o(),f(b,null,[s(A,null,{default:l(()=>[s(G,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=a=>e.tab=a),"align-tabs":"center",color:"deep-purple-accent-4"},{default:l(()=>[(o(!0),f(b,null,p(e.tabs_key,(a,d)=>(o(),i(N,{key:d,value:d},{default:l(()=>[h(g(a),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M,{modelValue:e.tab,"onUpdate:modelValue":t[5]||(t[5]=a=>e.tab=a)},{default:l(()=>[e.tab===0?(o(),i(_,{key:0},{default:l(()=>[s(P,{fluid:""},{default:l(()=>[ge,s(G,{style:{"margin-top":"16px"},modelValue:e.tabPlatform,"onUpdate:modelValue":t[1]||(t[1]=a=>e.tabPlatform=a),"align-tabs":"left",color:"deep-purple-accent-4"},{default:l(()=>[(o(!0),f(b,null,p(e.config_data.platform,(a,d)=>(o(),i(N,{key:d,value:d},{default:l(()=>[h(g(a.id)+"("+g(a.name)+") ",1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M,{modelValue:e.tabPlatform,"onUpdate:modelValue":t[2]||(t[2]=a=>e.tabPlatform=a)},{default:l(()=>[(o(!0),f(b,null,p(e.config_data.platform,(a,d)=>k((o(),i(_,{key:d,value:d},{default:l(()=>[s(P,null,{default:l(()=>[s(v,{metadata:e.metadata,iterable:a,metadataKey:"platform"},null,8,["metadata","iterable"])]),_:2},1024)]),_:2},1032,["value"])),[[F,e.tabPlatform===d]])),128))]),_:1},8,["modelValue"]),ce,s(v,{metadata:e.metadata,iterable:e.config_data.platform_settings,metadataKey:"platform_settings"},null,8,["metadata","iterable"])]),_:1})]),_:1})):V("",!0),e.tab===1?(o(),i(_,{key:1},{default:l(()=>[s(P,{fluid:""},{default:l(()=>[_e,s(G,{modelValue:e.tabLLM,"onUpdate:modelValue":t[3]||(t[3]=a=>e.tabLLM=a),"align-tabs":"left",color:"deep-purple-accent-4"},{default:l(()=>[(o(!0),f(b,null,p(e.config_data.llm,(a,d)=>(o(),i(N,{key:d,value:d},{default:l(()=>[h(g(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M,{modelValue:e.tabLLM,"onUpdate:modelValue":t[4]||(t[4]=a=>e.tabLLM=a)},{default:l(()=>[(o(!0),f(b,null,p(e.config_data.llm,(a,d)=>k((o(),i(_,{key:d,value:d},{default:l(()=>[s(P,null,{default:l(()=>[s(v,{metadata:e.metadata,iterable:a,metadataKey:"llm"},null,8,["metadata","iterable"]),s(v,{metadata:e.metadata.llm.items,iterable:a.model_config,metadataKey:"model_config"},null,8,["metadata","iterable"])]),_:2},1024)]),_:2},1032,["value"])),[[F,e.tabLLM===d]])),128))]),_:1},8,["modelValue"]),be,s(v,{metadata:e.metadata,iterable:e.config_data.llm_settings,metadataKey:"llm_settings"},null,8,["metadata","iterable"])]),_:1})]),_:1})):V("",!0),e.tab===2?(o(),i(_,{key:2},{default:l(()=>[s(P,{fluid:""},{default:l(()=>[s(D,{style:{"margin-top":"16px"}},{default:l(()=>[(o(!0),f(b,null,p(e.common_configs_key,a=>{var d,n,C,y,U,w,K,L;return o(),f("div",{key:a},[((d=e.metadata[a])==null?void 0:d.type)==="string"&&a!=="name"?(o(),i(B,{key:0,modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,label:((n=e.metadata[a])==null?void 0:n.description)+"("+a+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):V("",!0),((C=e.metadata[a])==null?void 0:C.type)==="int"&&a!=="name"?(o(),i(B,{key:1,modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,label:((y=e.metadata[a])==null?void 0:y.description)+"("+a+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):((U=e.metadata[a])==null?void 0:U.type)==="bool"?(o(),i(z,{key:2,modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,label:((w=e.metadata[a])==null?void 0:w.description)+"("+a+")",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label"])):((K=e.metadata[a])==null?void 0:K.type)==="list"?(o(),i(E,{key:3,variant:"outlined",modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,chips:"",clearable:"",label:((L=e.metadata[a])==null?void 0:L.description)+"("+a+")",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:l(({attrs:u,item:S,select:T,selected:r})=>[s(J,Q(u,{"model-value":r,closable:"",onClick:T,"onClick:close":j=>e.remove(S)}),{default:l(()=>[c("strong",null,g(S),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])):V("",!0)])}),128))]),_:1})]),_:1})]),_:1})):V("",!0)]),_:1},8,["modelValue"])]),_:1}),s(q,{icon:"mdi-content-save",size:"x-large",style:{position:"fixed",right:"52px",bottom:"52px"},color:"darkprimary",onClick:e.updateConfig},null,8,["onClick"]),s(ae,{timeout:2e3,elevation:"24",color:e.save_message_success,modelValue:e.save_message_snack,"onUpdate:modelValue":t[6]||(t[6]=a=>e.save_message_snack=a)},{default:l(()=>[h(g(e.save_message),1)]),_:1},8,["color","modelValue"])],64)}}});export{Ue as default};
