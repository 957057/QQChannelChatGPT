import{x as I,o,c as i,w as l,a as s,a8 as W,b as c,K as X,e as v,t as g,G as Y,A as Z,L as N,a9 as $,J as A,s as f,d as q,F as p,u as b,V as x,O as B,k as V,ac as z,ad as E,i as J,q as Q,p as D,a3 as j,N as S,ab as ee,T as O,a4 as G,Q as R,R as F}from"./index-b457b676.js";import{_ as ae}from"./ConfigDetailCard-a640ede2.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./UiParentCard.vue_vue_type_script_setup_true_lang-b380931c.js";const le={class:"d-sm-flex align-center justify-space-between"},oe=I({__name:"ConfigGroupCard",props:{title:String},setup(m){const e=m;return(t,_)=>(o(),i(A,{variant:"outlined",elevation:"0",class:"withbg",style:{width:"50%"}},{default:l(()=>[s(W,{style:{padding:"10px 20px"}},{default:l(()=>[c("div",le,[s(X,null,{default:l(()=>[v(g(e.title),1)]),_:1}),s(Y)])]),_:1}),s(Z),s(N,null,{default:l(()=>[$(t.$slots,"default")]),_:3})]),_:3}))}}),se={style:{display:"flex","flex-direction":"row","justify-content":"space-between","align-items":"center","margin-bottom":"12px"}},ne={style:{display:"flex","flex-direction":"row"}},de={style:{"margin-right":"10px",color:"black"}},ie={style:{color:"#222"}},me=I({__name:"ConfigGroupItem",props:{title:String,desc:String,btnRoute:String,namespace:String},setup(m){const e=m;return(t,_)=>(o(),f("div",se,[c("div",ne,[c("h3",de,g(e.title),1),c("p",ie,g(e.desc),1)]),s(q,{to:e.btnRoute,color:"primary",class:"ml-2",style:{"border-radius":"10px"}},{default:l(()=>[v("配置")]),_:1},8,["to"])]))}}),ue={props:{metadata:Object,iterable:Object,metadataKey:String}};function re(m,e,t,_,M,a){return o(),i(N,{style:{"margin-top":"8px"}},{default:l(()=>[(o(!0),f(p,null,b(t.iterable,(d,n)=>(o(),i(x,{key:n,style:{"margin-bottom":"2px"}},{default:l(()=>{var h,C,y,U,w,L,u,K;return[((h=t.metadata[t.metadataKey].items[n])==null?void 0:h.type)==="string"&&n!=="name"?(o(),i(B,{key:0,modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,label:((C=t.metadata[t.metadataKey].items[n])==null?void 0:C.description)+"("+n+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):V("",!0),((y=t.metadata[t.metadataKey].items[n])==null?void 0:y.type)==="int"&&n!=="name"?(o(),i(B,{key:1,modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,label:((U=t.metadata[t.metadataKey].items[n])==null?void 0:U.description)+"("+n+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):((w=t.metadata[t.metadataKey].items[n])==null?void 0:w.type)==="bool"?(o(),i(z,{key:2,modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,label:((L=t.metadata[t.metadataKey].items[n])==null?void 0:L.description)+"("+n+")",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label"])):((u=t.metadata[t.metadataKey].items[n])==null?void 0:u.type)==="list"?(o(),i(E,{key:3,variant:"outlined",modelValue:t.iterable[n],"onUpdate:modelValue":r=>t.iterable[n]=r,chips:"",clearable:"",label:((K=t.metadata[t.metadataKey].items[n])==null?void 0:K.description)+"("+n+")",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:l(({attrs:r,item:T,select:k,selected:H})=>[s(J,Q(r,{"model-value":H,closable:"",onClick:k,"onClick:close":be=>m.remove(T)}),{default:l(()=>[c("strong",null,g(T),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])):V("",!0)]}),_:2},1024))),128))]),_:1})}const P=te(ue,[["render",re]]);const fe=c("h2",null,"消息平台",-1),ge=c("h2",{style:{"margin-bottom":"16px","margin-top":"16px"}},"通用配置",-1),ce=c("h2",null,"LLM",-1),_e=c("h2",{style:{"margin-bottom":"16px"}},"通用配置",-1),pe={name:"ConfigPage",components:{ConfigGroupCard:oe,ConfigGroupItem:me,ConfigDetailCard:ae,AstrBotConfig:P},data(){return{config_data:{config:{platform:[],llm:[],platform_settings:{},llm_settings:{}}},metadata:{},save_message_snack:!1,save_message:"",save_message_success:"",namespace:"",tab:0,tabPlatform:0,tabLLM:0,tabs_key:["消息平台","大语言模型","其他配置"],common_configs_key:[]}},mounted(){this.getConfig()},methods:{getConfig(){O.get("/api/configs").then(m=>{this.config_data=m.data.data.config,this.metadata=m.data.data.metadata;for(let e in this.config_data)e!="platform"&&e!="llm"&&e!="platform_settings"&&e!="llm_settings"&&e!="content_safety"&&this.common_configs_key.push(e)}).catch(m=>{save_message=m,save_message_snack=!0,save_message_success="error"})},updateConfig(){O.post("/api/astrbot-configs",this.config_data).then(m=>{m.data.status==="success"?(this.save_message=m.data.message,this.save_message_snack=!0,this.save_message_success="success"):(this.save_message=m.data.message,this.save_message_snack=!0,this.save_message_success="error")}).catch(m=>{this.save_message=m,this.save_message_snack=!0,this.save_message_success="error"})}}},ye=Object.assign(pe,{setup(m){return(e,t)=>{const _=D("v-tabs-window-item"),M=D("v-tabs-window");return o(),f(p,null,[s(A,null,{default:l(()=>[s(j,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=a=>e.tab=a),"align-tabs":"center",color:"deep-purple-accent-4"},{default:l(()=>[(o(!0),f(p,null,b(e.tabs_key,(a,d)=>(o(),i(G,{key:d,value:d},{default:l(()=>[v(g(a),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M,{modelValue:e.tab,"onUpdate:modelValue":t[5]||(t[5]=a=>e.tab=a)},{default:l(()=>[e.tab===0?(o(),i(_,{key:0},{default:l(()=>[s(S,{fluid:""},{default:l(()=>[fe,s(j,{style:{"margin-top":"16px"},modelValue:e.tabPlatform,"onUpdate:modelValue":t[1]||(t[1]=a=>e.tabPlatform=a),"align-tabs":"left",color:"deep-purple-accent-4"},{default:l(()=>[(o(!0),f(p,null,b(e.config_data.platform,(a,d)=>(o(),i(G,{key:d,value:d},{default:l(()=>[v(g(a.id)+"("+g(a.name)+") ",1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M,{modelValue:e.tabPlatform,"onUpdate:modelValue":t[2]||(t[2]=a=>e.tabPlatform=a)},{default:l(()=>[(o(!0),f(p,null,b(e.config_data.platform,(a,d)=>R((o(),i(_,{key:d,value:d},{default:l(()=>[s(S,null,{default:l(()=>[s(P,{metadata:e.metadata,iterable:a,metadataKey:"platform"},null,8,["metadata","iterable"])]),_:2},1024)]),_:2},1032,["value"])),[[F,e.tabPlatform===d]])),128))]),_:1},8,["modelValue"]),ge,s(P,{metadata:e.metadata,iterable:e.config_data.platform_settings,metadataKey:"platform_settings"},null,8,["metadata","iterable"])]),_:1})]),_:1})):V("",!0),e.tab===1?(o(),i(_,{key:1},{default:l(()=>[s(S,{fluid:""},{default:l(()=>[ce,s(j,{modelValue:e.tabLLM,"onUpdate:modelValue":t[3]||(t[3]=a=>e.tabLLM=a),"align-tabs":"left",color:"deep-purple-accent-4"},{default:l(()=>[(o(!0),f(p,null,b(e.config_data.llm,(a,d)=>(o(),i(G,{key:d,value:d},{default:l(()=>[v(g(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(M,{modelValue:e.tabLLM,"onUpdate:modelValue":t[4]||(t[4]=a=>e.tabLLM=a)},{default:l(()=>[(o(!0),f(p,null,b(e.config_data.llm,(a,d)=>R((o(),i(_,{key:d,value:d},{default:l(()=>[s(S,null,{default:l(()=>[s(P,{metadata:e.metadata,iterable:a,metadataKey:"llm"},null,8,["metadata","iterable"])]),_:2},1024)]),_:2},1032,["value"])),[[F,e.tabLLM===d]])),128))]),_:1},8,["modelValue"]),_e,s(P,{metadata:e.metadata,iterable:e.config_data.llm_settings,metadataKey:"llm_settings"},null,8,["metadata","iterable"])]),_:1})]),_:1})):V("",!0),e.tab===2?(o(),i(_,{key:2},{default:l(()=>[s(S,{fluid:""},{default:l(()=>[s(N,{style:{"margin-top":"16px"}},{default:l(()=>[(o(!0),f(p,null,b(e.common_configs_key,a=>{var d,n,h,C,y,U,w,L;return o(),f("div",{key:a},[((d=e.metadata[a])==null?void 0:d.type)==="string"&&a!=="name"?(o(),i(B,{key:0,modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,label:((n=e.metadata[a])==null?void 0:n.description)+"("+a+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):V("",!0),((h=e.metadata[a])==null?void 0:h.type)==="int"&&a!=="name"?(o(),i(B,{key:1,modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,label:((C=e.metadata[a])==null?void 0:C.description)+"("+a+")",variant:"outlined",dense:""},null,8,["modelValue","onUpdate:modelValue","label"])):((y=e.metadata[a])==null?void 0:y.type)==="bool"?(o(),i(z,{key:2,modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,label:((U=e.metadata[a])==null?void 0:U.description)+"("+a+")",color:"primary",inset:""},null,8,["modelValue","onUpdate:modelValue","label"])):((w=e.metadata[a])==null?void 0:w.type)==="list"?(o(),i(E,{key:3,variant:"outlined",modelValue:e.config_data[a],"onUpdate:modelValue":u=>e.config_data[a]=u,chips:"",clearable:"",label:((L=e.metadata[a])==null?void 0:L.description)+"("+a+")",multiple:"","prepend-icon":"mdi-tag-multiple-outline"},{selection:l(({attrs:u,item:K,select:r,selected:T})=>[s(J,Q(u,{"model-value":T,closable:"",onClick:r,"onClick:close":k=>e.remove(K)}),{default:l(()=>[c("strong",null,g(K),1)]),_:2},1040,["model-value","onClick","onClick:close"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])):V("",!0)])}),128))]),_:1})]),_:1})]),_:1})):V("",!0)]),_:1},8,["modelValue"])]),_:1}),s(q,{icon:"mdi-content-save",size:"x-large",style:{position:"fixed",right:"52px",bottom:"52px"},color:"darkprimary",onClick:e.updateConfig},null,8,["onClick"]),s(ee,{timeout:2e3,elevation:"24",color:e.save_message_success,modelValue:e.save_message_snack,"onUpdate:modelValue":t[6]||(t[6]=a=>e.save_message_snack=a)},{default:l(()=>[v(g(e.save_message),1)]),_:1},8,["color","modelValue"])],64)}}});export{ye as default};
