import{d as J,o as v,c as V,a as K,w as t,b as e,V as O,e as d,t as w,f as B,g as D,h as Q,i as X,j as Y,k as A,s as Z,l as T,r as ee,F as te,m as ae,n as o,u as i,p as le,q as x,v as h,x as L,y as p,z as k,A as P,B as U,C as M,D as F,E as I,G as se,H as z,I as b,J as $,K as q,L as ie,M as oe,N as ne,O as de,P as re,Q as ue,R as me,S as ce,T as fe}from"./index-59964cc6.js";import{m as H}from"./md5-7290f9de.js";const y={Sidebar_drawer:!0,Customizer_drawer:!1,mini_sidebar:!1,fontTheme:"Roboto",inputBg:!1},E=J({id:"customizer",state:()=>({Sidebar_drawer:y.Sidebar_drawer,Customizer_drawer:y.Customizer_drawer,mini_sidebar:y.mini_sidebar,fontTheme:"Poppins",inputBg:y.inputBg}),getters:{},actions:{SET_SIDEBAR_DRAWER(){this.Sidebar_drawer=!this.Sidebar_drawer},SET_MINI_SIDEBAR(a){this.mini_sidebar=a},SET_FONT(a){this.fontTheme=a}}}),pe=[{title:"面板",icon:"mdi-view-dashboard",to:"/dashboard/default"},{title:"配置",icon:"mdi-cog",to:"/config"},{title:"插件",icon:"mdi-puzzle",to:"/extension"},{title:"控制台",icon:"mdi-console",to:"/console"},{title:"模型微调",icon:"mdi-grain",to:"/fine-tune"}],W={__name:"NavItem",props:{item:Object,level:Number},setup(a){return(c,r)=>(v(),V(Y,{to:a.item.type==="external"?"":a.item.to,href:a.item.type==="external"?a.item.to:"",rounded:"",class:"mb-1",color:"secondary",disabled:a.item.disabled,target:a.item.type==="external"?"_blank":""},K({prepend:t(()=>[a.item.icon?(v(),V(B,{key:0,size:a.item.iconSize,class:"hide-menu",icon:a.item.icon},null,8,["size","icon"])):D("",!0)]),default:t(()=>[e(Q,null,{default:t(()=>[d(w(a.item.title),1)]),_:1}),a.item.subCaption?(v(),V(X,{key:0,class:"text-caption mt-n1 hide-menu"},{default:t(()=>[d(w(a.item.subCaption),1)]),_:1})):D("",!0)]),_:2},[a.item.chip?{name:"append",fn:t(()=>[e(O,{color:a.item.chipColor,class:"sidebarchip hide-menu",size:a.item.chipIcon?"small":"default",variant:a.item.chipVariant,"prepend-icon":a.item.chipIcon},{default:t(()=>[d(w(a.item.chip),1)]),_:1},8,["color","size","variant","prepend-icon"])]),key:"0"}:void 0]),1032,["to","href","disabled","target"]))}},ve={class:"text-center"},he={name:"VerticalSidebar",components:{NavItem:W},data:()=>({version:"-"}),mounted(){this.get_version()},methods:{get_version(){x.get("/api/stat/version").then(a=>{this.version=a.data.data.version}).catch(a=>{console.log(a)})}}},_e=A({...he,setup(a){const c=E(),r=Z(pe);return(f,u)=>(v(),V(le,{left:"",modelValue:i(c).Sidebar_drawer,"onUpdate:modelValue":u[0]||(u[0]=m=>i(c).Sidebar_drawer=m),elevation:"0","rail-width":"80","mobile-breakpoint":"960",app:"",class:"leftSidebar",rail:i(c).mini_sidebar},{default:t(()=>[e(ae,{class:"pa-4 listitem",style:{height:"auto"}},{default:t(()=>[(v(!0),T(te,null,ee(r.value,(m,g)=>(v(),V(W,{key:g,item:m,class:"leftPadding"},null,8,["item"]))),128))]),_:1}),o("div",ve,[e(O,{color:"inputBorder",size:"small"},{default:t(()=>[d(" v"+w(f.version),1)]),_:1})])]),_:1},8,["modelValue","rail"]))}}),be=o("span",{style:{"margin-left":"16px","font-size":"24px","font-weight":"1000"}},[d("Astr"),o("span",{style:{"font-weight":"normal"}},"Bot")],-1),Ve={class:"mr-4"},ge={key:0},we={key:1},Se=o("span",{class:"text-h5"},"更新项目",-1),ye=o("h3",{class:"mb-4"},"升级到最新版本",-1),xe={style:{"margin-top":"16px"}},Ce=o("h3",{class:"mb-4"},"切换到指定版本或指定提交",-1),ke=o("div",{class:"mb-4"},[o("small",null,"如 v3.3.16 (不带 SHA) 或 42e5ec5d80b93b6bfe8b566754d45ffac4c3fe0b"),o("br"),o("a",{href:"https://github.com/Soulter/AstrBot/commits/master"},[o("small",null,"查看 master 分支提交记录（点击右边的 copy 即可复制）")])],-1),ze=o("span",{class:"text-h5"},"密码修改",-1),Be=o("small",null,"如果是第一次修改密码，原密码请留空。",-1),Te=o("br",null,null,-1),Ie=A({__name:"VerticalHeader",setup(a){const c=E();h(!1);let r=h(!1),f=h(!1),u=h(""),m=h(""),g=h(""),_=h(""),C=h(!1),S=h("");const j=n=>{window.open(n,"_blank")};function G(){u.value!=""&&(u.value=H.md5(u.value)),m.value=H.md5(m.value),x.post("/api/auth/password/reset",{password:u.value,new_password:m.value}).then(n=>{if(n.data.status=="error"){g.value=n.data.message,u.value="",m.value="";return}r.value=!r.value,g.value=n.data.message,setTimeout(()=>{de().logout()},1e3)}).catch(n=>{console.log(n),g.value=n,u.value="",m.value=""})}function R(){_.value="正在检查更新...",x.get("/api/update/check").then(n=>{C.value=n.data.data.has_new_version,_.value=n.data.message}).catch(n=>{console.log(n),_.value=n})}function N(n){_.value="正在切换版本...",x.post("/api/update/do",{version:n}).then(l=>{_.value=l.data.message,l.data.status=="success"&&setTimeout(()=>{window.location.reload()},1e3)}).catch(l=>{console.log(l),_.value=l})}return R(),(n,l)=>(v(),V(ne,{elevation:"0",height:"70"},{default:t(()=>[e(p,{style:{"margin-left":"22px"},class:"hidden-md-and-down text-secondary",color:"lightsecondary",icon:"",rounded:"sm",variant:"flat",onClick:l[0]||(l[0]=L(s=>i(c).SET_MINI_SIDEBAR(!i(c).mini_sidebar),["stop"])),size:"small"},{default:t(()=>[e(B,null,{default:t(()=>[d("mdi-menu")]),_:1})]),_:1}),e(p,{class:"hidden-lg-and-up text-secondary ms-3",color:"lightsecondary",icon:"",rounded:"sm",variant:"flat",onClick:L(i(c).SET_SIDEBAR_DRAWER,["stop"]),size:"small"},{default:t(()=>[e(B,null,{default:t(()=>[d("mdi-menu")]),_:1})]),_:1},8,["onClick"]),be,e(k),o("div",Ve,[i(C)?(v(),T("small",ge," 有新版本！ ")):(v(),T("small",we," 当前版本已是最新 "))]),e(q,{modelValue:i(f),"onUpdate:modelValue":l[5]||(l[5]=s=>b(f)?f.value=s:f=s),width:"700"},{activator:t(({props:s})=>[e(p,P({onClick:R,class:"text-primary mr-4",color:"lightprimary",variant:"flat",rounded:"sm"},s),{default:t(()=>[d(" 更新 🔄 ")]),_:2},1040)]),default:t(()=>[e(U,null,{default:t(()=>[e(M,null,{default:t(()=>[Se]),_:1}),e(F,null,{default:t(()=>[e(I,null,{default:t(()=>[ye,o("p",null,w(i(_)),1),e(p,{class:"mt-4 mb-4",onClick:l[1]||(l[1]=s=>N("latest")),color:"primary",style:{"border-radius":"10px"},disabled:!i(C)},{default:t(()=>[d(" 更新到最新版本 ")]),_:1},8,["disabled"]),e(se),o("div",xe,[Ce,e(z,{label:"输入版本号或 master 分支下的 commit hash。",modelValue:i(S),"onUpdate:modelValue":l[2]||(l[2]=s=>b(S)?S.value=s:S=s),required:"",variant:"outlined"},null,8,["modelValue"]),ke,e(p,{color:"error",style:{"border-radius":"10px"},onClick:l[3]||(l[3]=s=>N(i(S)))},{default:t(()=>[d(" 确定切换 ")]),_:1})])]),_:1})]),_:1}),e($,null,{default:t(()=>[e(k),e(p,{color:"blue-darken-1",variant:"text",onClick:l[4]||(l[4]=s=>b(f)?f.value=!1:f=!1)},{default:t(()=>[d(" 关闭 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(q,{modelValue:i(r),"onUpdate:modelValue":l[9]||(l[9]=s=>b(r)?r.value=s:r=s),persistent:"",width:"700"},{activator:t(({props:s})=>[e(p,P({class:"text-primary mr-4",color:"lightprimary",variant:"flat",rounded:"sm"},s),{default:t(()=>[d(" 密码修改 📰 ")]),_:2},1040)]),default:t(()=>[e(U,null,{default:t(()=>[e(M,null,{default:t(()=>[ze]),_:1}),e(F,null,{default:t(()=>[e(I,null,{default:t(()=>[e(ie,null,{default:t(()=>[e(oe,{cols:"12"},{default:t(()=>[e(z,{label:"原密码*",type:"password",modelValue:i(u),"onUpdate:modelValue":l[6]||(l[6]=s=>b(u)?u.value=s:u=s),required:"",variant:"outlined"},null,8,["modelValue"]),e(z,{label:"新密码*",type:"password",modelValue:i(m),"onUpdate:modelValue":l[7]||(l[7]=s=>b(m)?m.value=s:m=s),required:"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),Be,Te,o("small",null,w(i(g)),1)]),_:1}),e($,null,{default:t(()=>[e(k),e(p,{color:"blue-darken-1",variant:"text",onClick:l[8]||(l[8]=s=>b(r)?r.value=!1:r=!1)},{default:t(()=>[d(" 关闭 ")]),_:1}),e(p,{color:"blue-darken-1",variant:"text",onClick:G},{default:t(()=>[d(" 提交 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(p,{class:"text-primary mr-4",onClick:l[10]||(l[10]=s=>j("https://github.com/Soulter/AstrBot")),color:"lightprimary",variant:"flat",rounded:"sm"},{default:t(()=>[d(" GitHub Star! 🌟 ")]),_:1})]),_:1}))}}),Re=A({__name:"FullLayout",setup(a){const c=E();return(r,f)=>(v(),V(ce,null,{default:t(()=>[e(me,{theme:"PurpleTheme",class:ue([i(c).fontTheme,i(c).mini_sidebar?"mini-sidebar":"",i(c).inputBg?"inputWithbg":""])},{default:t(()=>[e(Ie),e(_e),e(re,null,{default:t(()=>[e(I,{fluid:"",class:"page-wrapper"},{default:t(()=>[o("div",null,[e(i(fe))])]),_:1})]),_:1})]),_:1},8,["class"])]),_:1}))}});export{Re as default};
